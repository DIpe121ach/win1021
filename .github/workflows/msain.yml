name: RDP-Deployment-System

on:
  workflow_dispatch:
    inputs:
      deployment_region:
        description: 'Select deployment region'
        required: false
        default: 'default'

jobs:
  deployment-controller:
    # âš ï¸ Ù…Ù„Ø§Ø­Ø¸Ø©: Ù…Ø¹ GitHub Actions Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ©ØŒ Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª Ù…Ø­Ø¯Ø¯Ø© Ù…Ø³Ø¨Ù‚Ø§Ù‹ ÙˆÙ„Ø§ ÙŠÙ…ÙƒÙ† ØªØºÙŠÙŠØ±Ù‡Ø§
    # Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©: 7GB RAMØŒ 2 Ø£Ù†ÙˆÙŠØ© CPU (Ù„Ù„Ø®Ø·Ø© Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ©)
    # Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…ÙˆØ§ØµÙØ§Øª Ø£Ø¹Ù„Ù‰ (32GB RAM / 8 cores)ØŒ ÙŠØ¬Ø¨:
    # 1. Ø´Ø±Ø§Ø¡ Ø®Ø·Ø© GitHub Enterprise
    # 2. Ø§Ø³ØªØ®Ø¯Ø§Ù… Self-hosted Runners Ø¹Ù„Ù‰ VPS Ø¨Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª
    # 3. Ø§Ø³ØªØ®Ø¯Ø§Ù… Larger Runners (Ù…Ø¯ÙÙˆØ¹Ø©)
    
    # Ù„ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆØ§ØµÙØ§Øª Ø¹Ø§Ù„ÙŠØ©ØŒ Ø§Ø³ØªØ¨Ø¯Ù„ Ø§Ù„Ø³Ø·Ø± Ø§Ù„ØªØ§Ù„ÙŠ:
    # runs-on: windows-2022
    
    # Ø¨Ù€:
    # runs-on:
    #   group: "Default"
    #   labels: ["windows-latest-xl"]  # ØªØ­ØªØ§Ø¬ Ø®Ø·Ø© Ù…Ø¯ÙÙˆØ¹Ø©
    
    runs-on: windows-2022
    
    timeout-minutes: 360
    env:
      CONFIG_SERVER: 'primary'
      DEPLOYMENT_TAG: 'rdp-node'
      # âš ï¸ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨: 32GB RAM / 8 cores CPU
      # âš ï¸ Ø§Ù„Ù…ØªØ§Ø­ Ø­Ø§Ù„ÙŠØ§Ù‹: 7GB RAM / 2 cores CPU
    
    steps:
      - name: system-specs-verification-module
        run: |
          # === Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù…ÙˆØ§ØµÙØ§Øª Ø§Ù„Ù†Ø¸Ø§Ù… ===
          Write-Host "================================" -ForegroundColor Cyan
          Write-Host "    Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª" -ForegroundColor Yellow
          Write-Host "================================" -ForegroundColor Cyan
          Write-Host "âš¡ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ù„Ù„Ø¹Ù…Ù„ Ø§Ù„Ø£Ù…Ø«Ù„:" -ForegroundColor Yellow
          Write-Host "   â€¢ 32GB RAM (Ø°Ø§ÙƒØ±Ø© ÙˆØµÙˆÙ„ Ø¹Ø´ÙˆØ§Ø¦ÙŠ)" -ForegroundColor White
          Write-Host "   â€¢ 8 cores CPU (Ù…Ø¹Ø§Ù„Ø¬ Ù…Ø±ÙƒØ²ÙŠ)" -ForegroundColor White
          Write-Host ""
          Write-Host "ğŸ“Š Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹:" -ForegroundColor Yellow
          
          # Ø¬Ù…Ø¹ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…
          $computerSystem = Get-CimInstance Win32_ComputerSystem
          $operatingSystem = Get-CimInstance Win32_OperatingSystem
          $processor = Get-CimInstance Win32_Processor
          
          $totalRAM = [math]::Round($computerSystem.TotalPhysicalMemory / 1GB, 2)
          $availableRAM = [math]::Round($operatingSystem.FreePhysicalMemory / 1MB, 2)
          $cpuCores = $processor.NumberOfLogicalProcessors
          $cpuName = $processor.Name
          
          Write-Host "   â€¢ RAM Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: $totalRAM GB" -ForegroundColor Green
          Write-Host "   â€¢ RAM Ø§Ù„Ù…ØªØ§Ø­: $availableRAM GB" -ForegroundColor Green
          Write-Host "   â€¢ Ø£Ù†ÙˆÙŠØ© CPU: $cpuCores" -ForegroundColor Green
          Write-Host "   â€¢ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬: $cpuName" -ForegroundColor Green
          
          # Ø§Ù„Ù…Ù‚Ø§Ø±Ù†Ø© Ù…Ø¹ Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª
          Write-Host ""
          Write-Host "ğŸ“ˆ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù…Ù‚Ø§Ø±Ù†Ø©:" -ForegroundColor Yellow
          
          $ramWarning = $false
          $cpuWarning = $false
          
          if ($totalRAM -lt 32) {
              $ramDiff = 32 - $totalRAM
              Write-Host "   âŒ RAM ØºÙŠØ± ÙƒØ§ÙÙŠØ© - Ù†Ø§Ù‚Øµ: $ramDiff GB" -ForegroundColor Red
              $ramWarning = $true
          } else {
              Write-Host "   âœ… RAM ÙƒØ§ÙÙŠØ©" -ForegroundColor Green
          }
          
          if ($cpuCores -lt 8) {
              $cpuDiff = 8 - $cpuCores
              Write-Host "   âŒ CPU ØºÙŠØ± ÙƒØ§ÙÙ - Ù†Ø§Ù‚Øµ: $cpuDiff Ø£Ù†ÙˆÙŠØ©" -ForegroundColor Red
              $cpuWarning = $true
          } else {
              Write-Host "   âœ… CPU ÙƒØ§ÙÙ" -ForegroundColor Green
          }
          
          # Ù†ØµØ§Ø¦Ø­ Ù„Ù„ØªØ±Ù‚ÙŠØ© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª ØºÙŠØ± ÙƒØ§ÙÙŠØ©
          if ($ramWarning -or $cpuWarning) {
              Write-Host ""
              Write-Host "ğŸ’¡ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…ÙˆØ§ØµÙØ§Øª Ø£Ø¹Ù„Ù‰ (32GB RAM / 8 cores):" -ForegroundColor Magenta
              Write-Host "   1. Ø§Ø³ØªØ®Ø¯Ù… Self-hosted Runners Ø¹Ù„Ù‰ VPS Ø¨Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª" -ForegroundColor White
              Write-Host "   2. Ø§Ø´ØªØ±ÙŠ Ø®Ø·Ø© GitHub Enterprise Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Larger Runners" -ForegroundColor White
              Write-Host "   3. Ø§Ø³ØªØ®Ø¯Ù… Ø®Ø¯Ù…Ø§Øª Cloud Ù…Ø«Ù„:" -ForegroundColor White
              Write-Host "      - AWS EC2: m6i.2xlarge (32GB RAM, 8 vCPU)" -ForegroundColor Gray
              Write-Host "      - Azure: Standard_E8s_v3 (64GB RAM, 8 vCPU)" -ForegroundColor Gray
              Write-Host "      - Google Cloud: e2-standard-8 (32GB RAM, 8 vCPU)" -ForegroundColor Gray
              Write-Host ""
              Write-Host "âš ï¸ Ø³ÙŠØ³ØªÙ…Ø± Ø§Ù„ØªØ´ØºÙŠÙ„ Ø¨Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©..." -ForegroundColor Yellow
          }
          
          # Ø­ÙØ¸ Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù„Ø§Ø­Ù‚
          echo "SYSTEM_SPECS=RAM:${totalRAM}GB,CPU:${cpuCores}cores" >> $env:GITHUB_ENV
          Write-Host "================================" -ForegroundColor Cyan

      - name: network-configuration-module
        run: |
          # === Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§ØªØµØ§Ù„ Ø³Ø·Ø­ Ø§Ù„Ù…ÙƒØªØ¨ Ø§Ù„Ø¨Ø¹ÙŠØ¯ ===
          Write-Host "Ø¨Ø¯Ø¡ ØªÙ‡ÙŠØ¦Ø© Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø´Ø¨ÙƒØ©..."
          
          Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server' `
                           -Name "fDenyTSConnections" -Value 0 -Force
          Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp' `
                           -Name "UserAuthentication" -Value 0 -Force
          Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp' `
                           -Name "SecurityLayer" -Value 0 -Force

          netsh advfirewall firewall delete rule name="Remote-Desktop-Access" 2>$null || Write-Host "ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©"
          netsh advfirewall firewall add rule name="Remote-Desktop-Access" `
            dir=in action=allow protocol=TCP localport=3389 `
            description="Allow RDP connections"

          Restart-Service -Name TermService -Force -ErrorAction Stop
          Write-Host "ØªÙ… ØªÙØ¹ÙŠÙ„ Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ Ø§Ù„Ø¨Ø¹ÙŠØ¯"

      - name: security-management-module
        run: |
          # === Ø¥Ø¯Ø§Ø±Ø© Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù… ===
          $admin_password = "Zxxz4444"
          $secure_password = ConvertTo-SecureString $admin_password -AsPlainText -Force
          $system_user = "RemoteAdmin"

          $user_exists = Get-LocalUser -Name $system_user -ErrorAction SilentlyContinue
          if ($user_exists) {
              Set-LocalUser -Name $system_user -Password $secure_password
              Write-Host "ØªÙ… ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ"
          } else {
              New-LocalUser -Name $system_user -Password $secure_password `
                           -FullName "Remote Access Administrator" `
                           -Description "Account for remote administration" `
                           -AccountNeverExpires
              
              Add-LocalGroupMember -Group "Administrators" -Member $system_user
              Add-LocalGroupMember -Group "Remote Desktop Users" -Member $system_user
              Write-Host "ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¥Ø¯Ø§Ø±ÙŠ Ø¬Ø¯ÙŠØ¯"
          }

          echo "CONNECTION_CREDENTIALS=Username: $system_user | Password: $admin_password" >> $env:GITHUB_ENV

          $verification = Get-LocalUser -Name $system_user
          if (-not $verification) {
              Write-Error "ÙØ´Ù„ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨"
              exit 1
          }

      - name: network-tools-installer
        run: |
          # === ØªÙ†Ø²ÙŠÙ„ ÙˆØªØ«Ø¨ÙŠØª Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø´Ø¨ÙƒØ© (Tailscale) ===
          $network_tools_url = "https://pkgs.tailscale.com/stable/tailscale-setup-latest-amd64.msi"
          $installation_path = "$env:TEMP\tailscale-installer.msi"
          
          try {
              Write-Host "Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Tailscale..."
              Invoke-WebRequest -Uri $network_tools_url -OutFile $installation_path `
                               -UseBasicParsing -ErrorAction Stop
              
              Write-Host "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ«Ø¨ÙŠØª Ø¨ØµÙ…Øª..."
              Start-Process msiexec.exe `
                -ArgumentList "/i", "`"$installation_path`"", "/quiet", "/norestart" `
                -Wait -NoNewWindow
              
              Remove-Item $installation_path -Force -ErrorAction SilentlyContinue
              Write-Host "ØªÙ… ØªØ«Ø¨ÙŠØª Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø´Ø¨ÙƒØ© Ø¨Ù†Ø¬Ø§Ø­"
          } catch {
              Write-Warning "ÙØ´Ù„ ÙÙŠ ØªØ«Ø¨ÙŠØª Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø´Ø¨ÙƒØ©: $_"
          }

      - name: vpn-connection-setup
        run: |
          # === Ø¥Ø¹Ø¯Ø§Ø¯ Ø§ØªØµØ§Ù„ Tailscale ===
          $tailscale_exe = Join-Path $env:ProgramFiles "Tailscale\tailscale.exe"
          
          if (Test-Path $tailscale_exe) {
              Write-Host "Ø¬Ø§Ø±ÙŠ ØªÙ‡ÙŠØ¦Ø© Ø§ØªØµØ§Ù„ Tailscale..."
              $auth_key = "${{ secrets.VPN_DEPLOYMENT_KEY }}"
              $host_identifier = "Deployment-Node-$env:GITHUB_RUN_NUMBER"
              
              & $tailscale_exe up --authkey=$auth_key --hostname=$host_identifier
          } else {
              Write-Error "Ø¨Ø±Ù†Ø§Ù…Ø¬ Tailscale ØºÙŠØ± Ù…Ø«Ø¨Øª"
              exit 1
          }

          # === Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¹Ù†ÙˆØ§Ù† IP ===
          Write-Host "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø´Ø¨ÙƒØ©..."
          $network_address = $null
          $connection_attempts = 0
          
          while (-not $network_address -and $connection_attempts -lt 15) {
              try { 
                  $network_address = & $tailscale_exe ip -4
                  if ($network_address) {
                      Write-Host "ØªÙ… Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: $network_address"
                      break
                  }
              } catch {
                  Write-Host "Ù…Ø­Ø§ÙˆÙ„Ø© $($connection_attempts + 1) Ù…Ù† 15..."
              }
              Start-Sleep -Seconds 4
              $connection_attempts++
          }

          if ($network_address) {
              echo "NETWORK_ADDRESS=$network_address" >> $env:GITHUB_ENV
          } else {
              Write-Error "ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø´Ø¨ÙƒØ© Ø¨Ø¹Ø¯ $connection_attempts Ù…Ø­Ø§ÙˆÙ„Ø©"
              exit 1
          }

      - name: connection-validation-module
        run: |
          # === Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¬Ø§Ù‡Ø²ÙŠØ© Ø§Ù„Ø§ØªØµØ§Ù„ ===
          Write-Host "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ØªØµØ§Ù„ $env:NETWORK_ADDRESS:3389"
          
          $connection_test = Test-NetConnection -ComputerName $env:NETWORK_ADDRESS `
                                               -Port 3389 -InformationLevel Detailed
          
          if ($connection_test.TcpTestSucceeded) {
              Write-Host "Ø§Ù„Ø§ØªØµØ§Ù„ Ù…ØªØ§Ø­ âœ“ Ø²Ù…Ù† Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©: $($connection_test.PingReplyDetails.RoundtripTime)ms"
          } else {
              Write-Error "ÙØ´Ù„ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„"
              exit 1
          }

      - name: application-deployment-module
        run: |
          # === Ù†Ø´Ø± Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© ===
          Write-Host "Ø¨Ø¯Ø¡ Ø¹Ù…Ù„ÙŠØ© Ù†Ø´Ø± Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª..."
          
          $deployment_folder = "C:\DeploymentPackages"
          $public_desktop = "C:\Users\Public\Desktop"
          $user_profile = Join-Path "C:\Users" "RemoteAdmin"
          
          if (-not (Test-Path $deployment_folder)) { 
              New-Item -Path $deployment_folder -ItemType Directory | Out-Null 
          }

          $software_packages = @(
            @{
              PackageName = "RemoteAssist"
              DownloadURL = "https://github.com/rustdesk/rustdesk/releases/download/1.4.4/rustdesk-1.4.4-x86_64.exe"
              ActionType = "deploy_to_desktop"
              OutputName = "RemoteAssistant.exe"
            },
            @{
              PackageName = "SecureBrowser"
              DownloadURL = "https://assets.nstbrowser.io/prod/agent/x64/Nstbrowser%20Setup%201.17.11.exe"
              ActionType = "install_silent"
              InstallationPath = "C:\Program Files\Nstbrowser\nstbrowser.exe"
            }
          )

          foreach ($package in $software_packages) {
              $clean_name = ($package.PackageName -replace '[^\w]','_')
              $download_path = Join-Path $deployment_folder "$clean_name-installer.exe"
              
              Write-Host "Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ $($package.PackageName)..."
              try {
                  Invoke-WebRequest -Uri $package.DownloadURL -OutFile $download_path `
                                   -UseBasicParsing -ErrorAction Stop
                  Write-Host "ØªÙ… Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­"
              } catch {
                  Write-Warning "ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ $($package.PackageName): $_"
                  continue
              }

              switch ($package.ActionType) {
                  "deploy_to_desktop" {
                      $destination = Join-Path $public_desktop $package.OutputName
                      try {
                          Copy-Item -Path $download_path -Destination $destination -Force
                          Write-Host "ØªÙ… Ø§Ù„Ù†Ø´Ø± Ø¹Ù„Ù‰ Ø³Ø·Ø­ Ø§Ù„Ù…ÙƒØªØ¨ Ø§Ù„Ø¹Ø§Ù…"
                          
                          # Ù†Ø³Ø® Ø¥Ù„Ù‰ Ø³Ø·Ø­ Ø§Ù„Ù…ÙƒØªØ¨ Ø§Ù„Ø®Ø§Øµ Ø¨Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹
                          if (Test-Path $user_profile) {
                              $user_desktop = Join-Path $user_profile "Desktop"
                              if (Test-Path $user_desktop) {
                                  Copy-Item -Path $download_path -Destination (Join-Path $user_desktop $package.OutputName) -Force
                              }
                          }
                      } catch {
                          Write-Warning "ÙØ´Ù„ ÙÙŠ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ù†Ø´Ø±: $_"
                      }
                  }
                  
                  "install_silent" {
                      Write-Host "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ«Ø¨ÙŠØª Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù€ $($package.PackageName)"
                      try {
                          # Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„ØªØ«Ø¨ÙŠØª Ø§Ù„ØµØ§Ù…Øª Ø£ÙˆÙ„Ø§Ù‹
                          $install_process = Start-Process -FilePath $download_path `
                            -ArgumentList "/S", "/norestart" `
                            -Wait -PassThru -NoNewWindow
                          
                          Start-Sleep -Seconds 10
                          
                          if (Test-Path $package.InstallationPath) {
                              Write-Host "ØªÙ… Ø§Ù„ØªØ«Ø¨ÙŠØª Ø¨Ù†Ø¬Ø§Ø­ âœ“"
                          } else {
                              Write-Warning "Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…Ø«Ø¨ØªØŒ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰..."
                              # Ù…Ø­Ø§ÙˆÙ„Ø© Ø¨Ø¯ÙŠÙ„Ø©
                              Start-Process -FilePath $download_path -Wait -NoNewWindow
                          }
                      } catch {
                          Write-Warning "ÙØ´Ù„ Ø§Ù„ØªØ«Ø¨ÙŠØª: $_"
                      }
                  }
              }
          }
          
          Write-Host "Ø§ÙƒØªÙ…Ù„Øª Ø¹Ù…Ù„ÙŠØ© Ù†Ø´Ø± Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª"

      - name: deployment-summary-module
        run: |
          # === Ø¹Ø±Ø¶ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø´Ø± ===
          Write-Host ""
          Write-Host "=" * 60
          Write-Host "                    Ù…Ù„Ø®Øµ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ù†Ø´Ø±" -ForegroundColor Cyan
          Write-Host "=" * 60
          Write-Host "ğŸŒ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: $env:NETWORK_ADDRESS" -ForegroundColor Green
          Write-Host "ğŸ‘¤ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: RemoteAdmin" -ForegroundColor Green
          Write-Host "ğŸ”‘ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±: Zxxz4444" -ForegroundColor Green
          Write-Host "ğŸ†” Ù…Ø¹Ø±Ù Ø§Ù„Ù†Ø´Ø±: $env:GITHUB_RUN_ID" -ForegroundColor Green
          Write-Host "ğŸ’» Ø§Ù„Ù…ÙˆØ§ØµÙØ§Øª: $env:SYSTEM_SPECS" -ForegroundColor Green
          Write-Host ""
          Write-Host "ğŸ“‹ Ù„Ù„ØªÙˆØµÙŠÙ„ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… RDP:" -ForegroundColor Yellow
          Write-Host "   mstsc /v:$env:NETWORK_ADDRESS" -ForegroundColor White
          Write-Host "   Username: RemoteAdmin" -ForegroundColor White
          Write-Host "   Password: Zxxz4444" -ForegroundColor White
          Write-Host "=" * 60
          Write-Host ""

          # === Ø¥Ø¨Ù‚Ø§Ø¡ Ø§Ù„Ø¬Ù„Ø³Ø© Ù†Ø´Ø·Ø© ===
          Write-Host "â³ Ø¨Ø¯Ø¡ Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ Ù„Ù„Ø¬Ù„Ø³Ø© (350 Ø¯Ù‚ÙŠÙ‚Ø©)..." -ForegroundColor Magenta
          $session_timer = [System.Diagnostics.Stopwatch]::StartNew()
          while ($session_timer.Elapsed.TotalMinutes -lt 350) {
              $remaining = 350 - [math]::Floor($session_timer.Elapsed.TotalMinutes)
              $elapsed_minutes = [math]::Floor($session_timer.Elapsed.TotalMinutes)
              $progress_percent = [math]::Min(100, [math]::Round(($elapsed_minutes / 350) * 100, 2))
              
              Write-Host "[$(Get-Date -Format 'HH:mm:ss')] â±ï¸ Ù…Ø¯Ø© Ø§Ù„ØªØ´ØºÙŠÙ„: ${elapsed_minutes} Ø¯Ù‚ÙŠÙ‚Ø© | â³ Ù…ØªØ¨Ù‚ÙŠ: $remaining Ø¯Ù‚ÙŠÙ‚Ø© | ğŸ“Š Ø§Ù„ØªÙ‚Ø¯Ù…: $progress_percent%" -ForegroundColor Gray
              Start-Sleep -Seconds 300
          }
          
          Write-Host "â° Ø§Ù†ØªÙ‡Øª Ù…Ø¯Ø© Ø§Ù„Ø¬Ù„Ø³Ø© (350 Ø¯Ù‚ÙŠÙ‚Ø©)" -ForegroundColor Red
          Write-Host "ğŸš« Ø³ÙŠØªÙ… Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø§ØªØµØ§Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹" -ForegroundColor Red
